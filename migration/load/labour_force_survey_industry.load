load csv
    from '../data/2020_LFS Data Sheet_final-Industry Profiles-Transformed-Split.csv'
    (
        industry,
        yoy_employment_growth_pct_2019_2020,
        yoy_change_employment_2019_2020,
        total_employment_2020,
        workforce_employment_gender_2020_pct_men,
        workforce_employment_gender_2020_pct_women,
        workforce_provincial_average_pct_2020_men,
        workforce_provincial_average_pct_2020_women,
        workforce_employment_under_25_pct_2015,
        workforce_employment_under_25_pct_2020,
        workforce_employment_under_25_pct_average,
        workforce_employment_over_55_pct_2015,
        workforce_employment_over_55_pct_2020,
        workforce_employment_over_55_pct_average,
        employment_part_time_pct_2015,
        employment_part_time_pct_2020,
        employment_part_time_pct_average,
        employment_self_employment_pct_2015,
        employment_self_employment_pct_2020,
        employment_self_employment_pct_average,
        employment_temporary_pct_2015,
        employment_temporary_pct_2020,
        employment_temporary_pct_average,
        employment_firms_under_20_employees_pct_2015,
        employment_firms_under_20_employees_pct_2020,
        employment_firms_under_20_employees_pct_average,
        employment_private_sector_pct_2015,
        employment_private_sector_pct_2020,
        employment_private_sector_pct_average,
        employment_unemployment_rate_pct_2015,
        employment_unemployment_rate_pct_2020,
        employment_unemployment_rate_pct_average,
        earnings_men_2015,
        earnings_men_2021,
        earnings_men_average,
        earnings_women_2015,
        earnings_women_2021,
        earnings_women_average,
        earnings_youth_2015,
        earnings_youth_2021,
        earnings_youth_average,
        location_cariboo_employment_this_industry_pct,
        location_cariboo_employment_all_industries_pct,
        location_kootenay_employment_this_industry_pct,
        location_kootenay_employment_all_industries_pct,
        location_mainland_southwest_employment_this_industry_pct,
        location_mainland_southwest_employment_all_industries_pct,
        location_north_coast_nechako_employment_this_industry_pct,
        location_north_coast_nechako_employment_all_industries_pct,
        location_northeast_employment_this_industry_pct,
        location_northeast_employment_all_industries_pct,
        location_thompson_okanagan_employment_this_industry_pct,
        location_thompson_okanagan_employment_all_industries_pct,
        location_vancouver_island_coast_employment_this_industry_pct,
        location_vancouver_island_coast_employment_all_industries_pct
    )
    into postgresql:///ssot
    target table labour_force_survey_industry
    with
        null if 'NA',
        skip header = 4,
        fields optionally enclosed by '"',
        fields terminated by ',',
        drop indexes

    before load do
    $$ drop table if exists labour_force_survey_industry; $$,
    $$ create table if not exists labour_force_survey_industry
    (
        industry text primary key,
        yoy_employment_growth_pct_2019_2020 numeric,
        yoy_change_employment_2019_2020 numeric,
        total_employment_2020 numeric,
        workforce_employment_gender_2020_pct_men numeric,
        workforce_employment_gender_2020_pct_women numeric,
        workforce_provincial_average_pct_2020_men numeric,
        workforce_provincial_average_pct_2020_women numeric,
        workforce_employment_under_25_pct_2015 numeric,
        workforce_employment_under_25_pct_2020 numeric,
        workforce_employment_under_25_pct_average numeric,
        workforce_employment_over_55_pct_2015 numeric,
        workforce_employment_over_55_pct_2020 numeric,
        workforce_employment_over_55_pct_average numeric,
        employment_part_time_pct_2015 numeric,
        employment_part_time_pct_2020 numeric,
        employment_part_time_pct_average numeric,
        employment_self_employment_pct_2015 numeric,
        employment_self_employment_pct_2020 numeric,
        employment_self_employment_pct_average numeric,
        employment_temporary_pct_2015 numeric,
        employment_temporary_pct_2020 numeric,
        employment_temporary_pct_average numeric,
        employment_firms_under_20_employees_pct_2015 numeric,
        employment_firms_under_20_employees_pct_2020 numeric,
        employment_firms_under_20_employees_pct_average numeric,
        employment_private_sector_pct_2015 numeric,
        employment_private_sector_pct_2020 numeric,
        employment_private_sector_pct_average numeric,
        employment_unemployment_rate_pct_2015 numeric,
        employment_unemployment_rate_pct_2020 numeric,
        employment_unemployment_rate_pct_average numeric,
        earnings_men_2015 numeric,
        earnings_men_2021 numeric,
        earnings_men_average numeric,
        earnings_women_2015 numeric,
        earnings_women_2021 numeric,
        earnings_women_average numeric,
        earnings_youth_2015 numeric,
        earnings_youth_2021 numeric,
        earnings_youth_average numeric,
        location_cariboo_employment_this_industry_pct numeric,
        location_cariboo_employment_all_industries_pct numeric,
        location_kootenay_employment_this_industry_pct numeric,
        location_kootenay_employment_all_industries_pct numeric,
        location_mainland_southwest_employment_this_industry_pct numeric,
        location_mainland_southwest_employment_all_industries_pct numeric,
        location_north_coast_nechako_employment_this_industry_pct numeric,
        location_north_coast_nechako_employment_all_industries_pct numeric,
        location_northeast_employment_this_industry_pct numeric,
        location_northeast_employment_all_industries_pct numeric,
        location_thompson_okanagan_employment_this_industry_pct numeric,
        location_thompson_okanagan_employment_all_industries_pct numeric,
        location_vancouver_island_coast_employment_this_industry_pct numeric,
        location_vancouver_island_coast_employment_all_industries_pct numeric
    );
    $$

    after load do
    $$ comment on table labour_force_survey_industry is '2020_LFS Data Sheet_final > Industry Profiles'; $$,
    $$ comment on column labour_force_survey_industry.yoy_employment_growth_pct_2019_2020 is 'Overview: % yoy employment growth (2019-2020)'; $$,
    $$ comment on column labour_force_survey_industry.yoy_change_employment_2019_2020 is 'Overview: yoy change of employment (2019-2020)'; $$,
    $$ comment on column labour_force_survey_industry.total_employment_2020 is 'Overview: Total employment (2020)'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_gender_2020_pct_men is 'Workforce: Employment by gender in 2020 (%): Men'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_gender_2020_pct_women is 'Workforce: Employment by gender in 2020 (%): Women'; $$,
    $$ comment on column labour_force_survey_industry.workforce_provincial_average_pct_2020_men is 'Workforce: Provincial average in 2020 (%): Men'; $$,
    $$ comment on column labour_force_survey_industry.workforce_provincial_average_pct_2020_women is 'Workforce: Provincial average in 2020 (%): Women'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_under_25_pct_2015 is 'Workforce: % of employment under 25 years of age: 2015'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_under_25_pct_2020 is 'Workforce: % of employment under 25 years of age: 2020'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_under_25_pct_average is 'Workforce: % of employment under 25 years of age: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_over_55_pct_2015 is 'Workforce: % of employment 55 years and older: 2015'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_over_55_pct_2020 is 'Workforce: % of employment 55 years and older: 2020'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_over_55_pct_average is 'Workforce: % of employment 55 years and older: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.employment_part_time_pct_2015 is 'Employment: Part-time, % of total employment: 2015'; $$,
    $$ comment on column labour_force_survey_industry.employment_part_time_pct_2020 is 'Employment: Part-time, % of total employment: 2020'; $$,
    $$ comment on column labour_force_survey_industry.employment_part_time_pct_average is 'Employment: Part-time, % of total employment: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.employment_self_employment_pct_2015 is 'Employment: Self-employment, % of total employment: 2015'; $$,
    $$ comment on column labour_force_survey_industry.employment_self_employment_pct_2020 is 'Employment: Self-employment, % of total employment: 2020'; $$,
    $$ comment on column labour_force_survey_industry.employment_self_employment_pct_average is 'Employment: Self-employment, % of total employment: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.employment_temporary_pct_2015 is 'Employment: Temporary jobs, % of total employees: 2015'; $$,
    $$ comment on column labour_force_survey_industry.employment_temporary_pct_2020 is 'Employment: Temporary jobs, % of total employees: 2020'; $$,
    $$ comment on column labour_force_survey_industry.employment_temporary_pct_average is 'Employment: Temporary jobs, % of total employees: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.employment_firms_under_20_employees_pct_2015 is 'Employment: % of workers in firms less than 20 employees: 2015'; $$,
    $$ comment on column labour_force_survey_industry.employment_firms_under_20_employees_pct_2020 is 'Employment: % of workers in firms less than 20 employees: 2020'; $$,
    $$ comment on column labour_force_survey_industry.employment_firms_under_20_employees_pct_average is 'Employment: % of workers in firms less than 20 employees: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.employment_private_sector_pct_2015 is 'Employment: Private sector employees, % of total employment: 2015'; $$,
    $$ comment on column labour_force_survey_industry.employment_private_sector_pct_2020 is 'Employment: Private sector employees, % of total employment: 2020'; $$,
    $$ comment on column labour_force_survey_industry.employment_private_sector_pct_average is 'Employment: Private sector employees, % of total employment: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.employment_unemployment_rate_pct_2015 is 'Employment: Unemployment rate (%): 2015'; $$,
    $$ comment on column labour_force_survey_industry.employment_unemployment_rate_pct_2020 is 'Employment: Unemployment rate (%): 2020'; $$,
    $$ comment on column labour_force_survey_industry.employment_unemployment_rate_pct_average is 'Employment: Unemployment rate (%): B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.earnings_men_2015 is 'Earnings: Men: 2015'; $$,
    $$ comment on column labour_force_survey_industry.earnings_men_2021 is 'Earnings: Men: 2020'; $$,
    $$ comment on column labour_force_survey_industry.earnings_men_average is 'Earnings: Men: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.earnings_women_2015 is 'Earnings: Women: 2015'; $$,
    $$ comment on column labour_force_survey_industry.earnings_women_2021 is 'Earnings: Women: 2020'; $$,
    $$ comment on column labour_force_survey_industry.earnings_women_average is 'Earnings: Women: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.earnings_youth_2015 is 'Earnings: Youth: 2015'; $$,
    $$ comment on column labour_force_survey_industry.earnings_youth_2021 is 'Earnings: Youth: 2020'; $$,
    $$ comment on column labour_force_survey_industry.earnings_youth_average is 'Earnings: Youth: B.C. average (2020)'; $$,
    $$ comment on column labour_force_survey_industry.location_cariboo_employment_this_industry_pct is 'Location of Work: Cariboo: % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_cariboo_employment_all_industries_pct is 'Location of Work: Cariboo: % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_kootenay_employment_this_industry_pct is 'Location of Work: Kootenay: % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_kootenay_employment_all_industries_pct is 'Location of Work: Kootenay: % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_mainland_southwest_employment_this_industry_pct is 'Location of Work: Mainland/Southwest: % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_mainland_southwest_employment_all_industries_pct is 'Location of Work: Mainland/Southwest: % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_north_coast_nechako_employment_this_industry_pct is 'Location of Work: North Coast & Nechako: % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_north_coast_nechako_employment_all_industries_pct is 'Location of Work: North Coast & Nechako: % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_northeast_employment_this_industry_pct is 'Location of Work: Northeast: % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_northeast_employment_all_industries_pct is 'Location of Work: Northeast: % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_thompson_okanagan_employment_this_industry_pct is 'Location of Work: Thompson-Okanagan: % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_thompson_okanagan_employment_all_industries_pct is 'Location of Work: Thompson-Okanagan: % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_vancouver_island_coast_employment_this_industry_pct is 'Location of Work: Vancouver Island/Coast: % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_vancouver_island_coast_employment_all_industries_pct is 'Location of Work: Vancouver Island/Coast: % employment of B.C. all industries'; $$
;
