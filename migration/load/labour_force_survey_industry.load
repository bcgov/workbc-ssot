load csv
    from 'labour_force_survey_industry.csv'
    (
        industry,
        yoy_employment_growth_pct,
        yoy_change_employment,
        total_employment,
        workforce_employment_gender_pct_men,
        workforce_employment_gender_pct_women,
        workforce_provincial_average_pct_men,
        workforce_provincial_average_pct_women,
        workforce_employment_under_25_pct_previous,
        workforce_employment_under_25_pct,
        workforce_employment_under_25_pct_average,
        workforce_employment_over_55_pct_previous,
        workforce_employment_over_55_pct,
        workforce_employment_over_55_pct_average,
        employment_part_time_pct_previous,
        employment_part_time_pct,
        employment_part_time_pct_average,
        employment_self_employment_pct_previous,
        employment_self_employment_pct,
        employment_self_employment_pct_average,
        employment_temporary_pct_previous,
        employment_temporary_pct,
        employment_temporary_pct_average,
        employment_firms_under_20_employees_pct_previous,
        employment_firms_under_20_employees_pct,
        employment_firms_under_20_employees_pct_average,
        employment_private_sector_pct_previous,
        employment_private_sector_pct,
        employment_private_sector_pct_average,
        employment_unemployment_rate_pct_previous,
        employment_unemployment_rate_pct,
        employment_unemployment_rate_pct_average,
        earnings_men_previous,
        earnings_men,
        earnings_men_average,
        earnings_women_previous,
        earnings_women,
        earnings_women_average,
        earnings_youth_previous,
        earnings_youth,
        earnings_youth_average,
        location_cariboo_employment_this_industry_pct,
        location_cariboo_employment_all_industries_pct,
        location_kootenay_employment_this_industry_pct,
        location_kootenay_employment_all_industries_pct,
        location_mainland_southwest_employment_this_industry_pct,
        location_mainland_southwest_employment_all_industries_pct,
        location_north_coast_nechako_employment_this_industry_pct,
        location_north_coast_nechako_employment_all_industries_pct,
        location_northeast_employment_this_industry_pct,
        location_northeast_employment_all_industries_pct,
        location_thompson_okanagan_employment_this_industry_pct,
        location_thompson_okanagan_employment_all_industries_pct,
        location_vancouver_island_coast_employment_this_industry_pct,
        location_vancouver_island_coast_employment_all_industries_pct
    )
    into postgresql:///ssot
    target table labour_force_survey_industry
    target columns
    (
        industry,
        yoy_employment_growth_pct numeric using (not-available-to-null yoy_employment_growth_pct),
        yoy_change_employment numeric using (not-available-to-null yoy_change_employment),
        total_employment numeric using (not-available-to-null total_employment),
        workforce_employment_gender_pct_men numeric using (not-available-to-null workforce_employment_gender_pct_men),
        workforce_employment_gender_pct_women numeric using (not-available-to-null workforce_employment_gender_pct_women),
        workforce_provincial_average_pct_men numeric using (not-available-to-null workforce_provincial_average_pct_men),
        workforce_provincial_average_pct_women numeric using (not-available-to-null workforce_provincial_average_pct_women),
        workforce_employment_under_25_pct_previous numeric using (not-available-to-null workforce_employment_under_25_pct_previous),
        workforce_employment_under_25_pct numeric using (not-available-to-null workforce_employment_under_25_pct),
        workforce_employment_under_25_pct_average numeric using (not-available-to-null workforce_employment_under_25_pct_average),
        workforce_employment_over_55_pct_previous numeric using (not-available-to-null workforce_employment_over_55_pct_previous),
        workforce_employment_over_55_pct numeric using (not-available-to-null workforce_employment_over_55_pct),
        workforce_employment_over_55_pct_average numeric using (not-available-to-null workforce_employment_over_55_pct_average),
        employment_part_time_pct_previous numeric using (not-available-to-null employment_part_time_pct_previous),
        employment_part_time_pct numeric using (not-available-to-null employment_part_time_pct),
        employment_part_time_pct_average numeric using (not-available-to-null employment_part_time_pct_average),
        employment_self_employment_pct_previous numeric using (not-available-to-null employment_self_employment_pct_previous),
        employment_self_employment_pct numeric using (not-available-to-null employment_self_employment_pct),
        employment_self_employment_pct_average numeric using (not-available-to-null employment_self_employment_pct_average),
        employment_temporary_pct_previous numeric using (not-available-to-null employment_temporary_pct_previous),
        employment_temporary_pct numeric using (not-available-to-null employment_temporary_pct),
        employment_temporary_pct_average numeric using (not-available-to-null employment_temporary_pct_average),
        employment_firms_under_20_employees_pct_previous numeric using (not-available-to-null employment_firms_under_20_employees_pct_previous),
        employment_firms_under_20_employees_pct numeric using (not-available-to-null employment_firms_under_20_employees_pct),
        employment_firms_under_20_employees_pct_average numeric using (not-available-to-null employment_firms_under_20_employees_pct_average),
        employment_private_sector_pct_previous numeric using (not-available-to-null employment_private_sector_pct_previous),
        employment_private_sector_pct numeric using (not-available-to-null employment_private_sector_pct),
        employment_private_sector_pct_average numeric using (not-available-to-null employment_private_sector_pct_average),
        employment_unemployment_rate_pct_previous numeric using (not-available-to-null employment_unemployment_rate_pct_previous),
        employment_unemployment_rate_pct numeric using (not-available-to-null employment_unemployment_rate_pct),
        employment_unemployment_rate_pct_average numeric using (not-available-to-null employment_unemployment_rate_pct_average),
        earnings_men_previous numeric using (not-available-to-null earnings_men_previous),
        earnings_men numeric using (not-available-to-null earnings_men),
        earnings_men_average numeric using (not-available-to-null earnings_men_average),
        earnings_women_previous numeric using (not-available-to-null earnings_women_previous),
        earnings_women numeric using (not-available-to-null earnings_women),
        earnings_women_average numeric using (not-available-to-null earnings_women_average),
        earnings_youth_previous numeric using (not-available-to-null earnings_youth_previous),
        earnings_youth numeric using (not-available-to-null earnings_youth),
        earnings_youth_average numeric using (not-available-to-null earnings_youth_average),
        location_cariboo_employment_this_industry_pct numeric using (not-available-to-null location_cariboo_employment_this_industry_pct),
        location_cariboo_employment_all_industries_pct numeric using (not-available-to-null location_cariboo_employment_all_industries_pct),
        location_kootenay_employment_this_industry_pct numeric using (not-available-to-null location_kootenay_employment_this_industry_pct),
        location_kootenay_employment_all_industries_pct numeric using (not-available-to-null location_kootenay_employment_all_industries_pct),
        location_mainland_southwest_employment_this_industry_pct numeric using (not-available-to-null location_mainland_southwest_employment_this_industry_pct),
        location_mainland_southwest_employment_all_industries_pct numeric using (not-available-to-null location_mainland_southwest_employment_all_industries_pct),
        location_north_coast_nechako_employment_this_industry_pct numeric using (not-available-to-null location_north_coast_nechako_employment_this_industry_pct),
        location_north_coast_nechako_employment_all_industries_pct numeric using (not-available-to-null location_north_coast_nechako_employment_all_industries_pct),
        location_northeast_employment_this_industry_pct numeric using (not-available-to-null location_northeast_employment_this_industry_pct),
        location_northeast_employment_all_industries_pct numeric using (not-available-to-null location_northeast_employment_all_industries_pct),
        location_thompson_okanagan_employment_this_industry_pct numeric using (not-available-to-null location_thompson_okanagan_employment_this_industry_pct),
        location_thompson_okanagan_employment_all_industries_pct numeric using (not-available-to-null location_thompson_okanagan_employment_all_industries_pct),
        location_vancouver_island_coast_employment_this_industry_pct numeric using (not-available-to-null location_vancouver_island_coast_employment_this_industry_pct),
        location_vancouver_island_coast_employment_all_industries_pct numeric using (not-available-to-null location_vancouver_island_coast_employment_all_industries_pct)
    )
    with
        fields optionally enclosed by '"',
        fields terminated by ',',
        drop indexes

    before load do
    $$ drop table if exists labour_force_survey_industry; $$,
    $$ create table if not exists labour_force_survey_industry
    (
        industry citext primary key,
        yoy_employment_growth_pct numeric,
        yoy_change_employment numeric,
        total_employment numeric,
        workforce_employment_gender_pct_men numeric,
        workforce_employment_gender_pct_women numeric,
        workforce_provincial_average_pct_men numeric,
        workforce_provincial_average_pct_women numeric,
        workforce_employment_under_25_pct_previous numeric,
        workforce_employment_under_25_pct numeric,
        workforce_employment_under_25_pct_average numeric,
        workforce_employment_over_55_pct_previous numeric,
        workforce_employment_over_55_pct numeric,
        workforce_employment_over_55_pct_average numeric,
        employment_part_time_pct_previous numeric,
        employment_part_time_pct numeric,
        employment_part_time_pct_average numeric,
        employment_self_employment_pct_previous numeric,
        employment_self_employment_pct numeric,
        employment_self_employment_pct_average numeric,
        employment_temporary_pct_previous numeric,
        employment_temporary_pct numeric,
        employment_temporary_pct_average numeric,
        employment_firms_under_20_employees_pct_previous numeric,
        employment_firms_under_20_employees_pct numeric,
        employment_firms_under_20_employees_pct_average numeric,
        employment_private_sector_pct_previous numeric,
        employment_private_sector_pct numeric,
        employment_private_sector_pct_average numeric,
        employment_unemployment_rate_pct_previous numeric,
        employment_unemployment_rate_pct numeric,
        employment_unemployment_rate_pct_average numeric,
        earnings_men_previous numeric,
        earnings_men numeric,
        earnings_men_average numeric,
        earnings_women_previous numeric,
        earnings_women numeric,
        earnings_women_average numeric,
        earnings_youth_previous numeric,
        earnings_youth numeric,
        earnings_youth_average numeric,
        location_cariboo_employment_this_industry_pct numeric,
        location_cariboo_employment_all_industries_pct numeric,
        location_kootenay_employment_this_industry_pct numeric,
        location_kootenay_employment_all_industries_pct numeric,
        location_mainland_southwest_employment_this_industry_pct numeric,
        location_mainland_southwest_employment_all_industries_pct numeric,
        location_north_coast_nechako_employment_this_industry_pct numeric,
        location_north_coast_nechako_employment_all_industries_pct numeric,
        location_northeast_employment_this_industry_pct numeric,
        location_northeast_employment_all_industries_pct numeric,
        location_thompson_okanagan_employment_this_industry_pct numeric,
        location_thompson_okanagan_employment_all_industries_pct numeric,
        location_vancouver_island_coast_employment_this_industry_pct numeric,
        location_vancouver_island_coast_employment_all_industries_pct numeric
    );
    $$

    after load do
    $$ comment on table labour_force_survey_industry is 'LFS Data Sheet {2023} > Industry Profiles'; $$,
    $$ comment on column labour_force_survey_industry.industry is 'Industry'; $$,
    $$ comment on column labour_force_survey_industry.yoy_employment_growth_pct is 'Overview > % yoy employment growth {2022-2023}'; $$,
    $$ comment on column labour_force_survey_industry.yoy_change_employment is 'Overview > yoy change of employment {2022-2023}'; $$,
    $$ comment on column labour_force_survey_industry.total_employment is 'Overview > Total employment {2023}'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_gender_pct_men is 'Workforce > Employment by gender in {2023} (%) > Men'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_gender_pct_women is 'Workforce > Employment by gender in {2023} (%) > Women'; $$,
    $$ comment on column labour_force_survey_industry.workforce_provincial_average_pct_men is 'Workforce > Provincial average in {2023} (%) > Men'; $$,
    $$ comment on column labour_force_survey_industry.workforce_provincial_average_pct_women is 'Workforce > Provincial average in {2023} (%) > Women'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_under_25_pct_previous is 'Workforce > % of employment under 25 years of age > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_under_25_pct is 'Workforce > % of employment under 25 years of age > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_under_25_pct_average is 'Workforce > % of employment under 25 years of age > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_over_55_pct_previous is 'Workforce > % of employment 55 years and older > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_over_55_pct is 'Workforce > % of employment 55 years and older > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.workforce_employment_over_55_pct_average is 'Workforce > % of employment 55 years and older > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_part_time_pct_previous is 'Employment > Part-time, % of total employment > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.employment_part_time_pct is 'Employment > Part-time, % of total employment > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_part_time_pct_average is 'Employment > Part-time, % of total employment > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_self_employment_pct_previous is 'Employment > Self-employment, % of total employment > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.employment_self_employment_pct is 'Employment > Self-employment, % of total employment > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_self_employment_pct_average is 'Employment > Self-employment, % of total employment > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_temporary_pct_previous is 'Employment > Temporary jobs, % of total employees > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.employment_temporary_pct is 'Employment > Temporary jobs, % of total employees > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_temporary_pct_average is 'Employment > Temporary jobs, % of total employees > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_firms_under_20_employees_pct_previous is 'Employment > % of workers in firms less than 20 employees > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.employment_firms_under_20_employees_pct is 'Employment > % of workers in firms less than 20 employees > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_firms_under_20_employees_pct_average is 'Employment > % of workers in firms less than 20 employees > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_private_sector_pct_previous is 'Employment > Private sector employees, % of total employment > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.employment_private_sector_pct is 'Employment > Private sector employees, % of total employment > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_private_sector_pct_average is 'Employment > Private sector employees, % of total employment > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_unemployment_rate_pct_previous is 'Employment > Unemployment rate (%) > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.employment_unemployment_rate_pct is 'Employment > Unemployment rate (%) > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.employment_unemployment_rate_pct_average is 'Employment > Unemployment rate (%) > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_men_previous is 'Earnings > Men > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_men is 'Earnings > Men > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_men_average is 'Earnings > Men > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_women_previous is 'Earnings > Women > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_women is 'Earnings > Women > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_women_average is 'Earnings > Women > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_youth_previous is 'Earnings > Youth > {2018}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_youth is 'Earnings > Youth > {2023}'; $$,
    $$ comment on column labour_force_survey_industry.earnings_youth_average is 'Earnings > Youth > B.C. average {2023}'; $$,
    $$ comment on column labour_force_survey_industry.location_cariboo_employment_this_industry_pct is 'Location of Work > Cariboo > % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_cariboo_employment_all_industries_pct is 'Location of Work > Cariboo > % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_kootenay_employment_this_industry_pct is 'Location of Work > Kootenay > % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_kootenay_employment_all_industries_pct is 'Location of Work > Kootenay > % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_mainland_southwest_employment_this_industry_pct is 'Location of Work > Mainland/Southwest > % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_mainland_southwest_employment_all_industries_pct is 'Location of Work > Mainland/Southwest > % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_north_coast_nechako_employment_this_industry_pct is 'Location of Work > North Coast and Nechako > % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_north_coast_nechako_employment_all_industries_pct is 'Location of Work > North Coast and Nechako > % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_northeast_employment_this_industry_pct is 'Location of Work > Northeast > % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_northeast_employment_all_industries_pct is 'Location of Work > Northeast > % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_thompson_okanagan_employment_this_industry_pct is 'Location of Work > Thompson-Okanagan > % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_thompson_okanagan_employment_all_industries_pct is 'Location of Work > Thompson-Okanagan > % employment of B.C. all industries'; $$,
    $$ comment on column labour_force_survey_industry.location_vancouver_island_coast_employment_this_industry_pct is 'Location of Work > Vancouver Island/Coast > % employment of this industry'; $$,
    $$ comment on column labour_force_survey_industry.location_vancouver_island_coast_employment_all_industries_pct is 'Location of Work > Vancouver Island/Coast > % employment of B.C. all industries'; $$
;
