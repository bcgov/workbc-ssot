load csv
    from '{{ SOURCE }}'
    (
        year,
        month,

        total_employed,
        total_unemployed,
        total_unemployed_previous,

        employment_by_age_group_15_24,
        employment_by_age_group_25_54,
        employment_by_age_group_55,
        employment_by_age_group_15_24_previous,
        employment_by_age_group_25_54_previous,
        employment_by_age_group_55_previous,

        employment_by_gender_women,
        employment_by_gender_men,
        employment_by_gender_women_previous,
        employment_by_gender_men_previous,

        employment_change_pct_total_employment,
        employment_change_abs_total_employment,
        employment_change_pct_full_time_jobs,
        employment_change_abs_full_time_jobs,
        employment_change_pct_part_time_jobs,
        employment_change_abs_part_time_jobs,

        employment_rate_change_pct_unemployment,
        employment_rate_pct_unemployment,
        employment_rate_change_pct_participation,
        employment_rate_pct_participation,
        employment_rate_change_pct_unemployment_previous,
        employment_rate_pct_unemployment_previous,
        employment_rate_change_pct_participation_previous,
        employment_rate_pct_participation_previous,

        population_british_columbia,
        population_vancouver_island_and_coast,
        population_lower_mainland_southwest,
        population_thompson_okanagan,
        population_kootenay,
        population_cariboo,
        population_north_coast_and_nechako,
        population_northeast,

        unemployment_pct_british_columbia,
        unemployment_pct_british_columbia_previous,
        total_jobs_british_columbia,
        unemployment_pct_vancouver_island_coast,
        unemployment_pct_vancouver_island_coast_previous,
        total_jobs_vancouver_island_coast,
        unemployment_pct_mainland_southwest,
        unemployment_pct_mainland_southwest_previous,
        total_jobs_mainland_southwest,
        unemployment_pct_thompson_okanagan,
        unemployment_pct_thompson_okanagan_previous,
        total_jobs_thompson_okanagan,
        unemployment_pct_kootenay,
        unemployment_pct_kootenay_previous,
        total_jobs_kootenay,
        unemployment_pct_cariboo,
        unemployment_pct_cariboo_previous,
        total_jobs_cariboo,
        unemployment_pct_north_coast_and_nechako,
        unemployment_pct_north_coast_and_nechako_previous,
        total_jobs_north_coast_and_nechako,
        unemployment_pct_northeast,
        unemployment_pct_northeast_previous,
        total_jobs_northeast,

        city_unemployment_pct_kelowna,
        city_unemployment_pct_abbotsford_mission,
        city_unemployment_pct_vancouver,
        city_unemployment_pct_victoria,

        industry_pct_accommodation_and_food_services,
        industry_abs_accommodation_and_food_services,
        industry_pct_agriculture,
        industry_abs_agriculture,
        industry_pct_construction,
        industry_abs_construction,
        industry_pct_educational_services,
        industry_abs_educational_services,
        industry_pct_finance_insurance_real_estate_rental,
        industry_abs_finance_insurance_real_estate_rental,
        industry_pct_health_care_and_social_assistance,
        industry_abs_health_care_and_social_assistance,
        industry_pct_manufacturing,
        industry_abs_manufacturing,
        industry_pct_other_primary,
        industry_abs_other_primary,
        industry_pct_other_services,
        industry_abs_other_services,
        industry_pct_professional_scientific_and_technical,
        industry_abs_professional_scientific_and_technical,
        industry_pct_public_administration,
        industry_abs_public_administration,
        industry_pct_transportation_and_warehousing,
        industry_abs_transportation_and_warehousing,
        industry_pct_utilities,
        industry_abs_utilities,
        industry_pct_wholesale_and_retail_trade,
        industry_abs_wholesale_and_retail_trade
    )
    into postgresql:///ssot
    target table monthly_labour_market_updates
    with
        null if 'NA',
        skip header = 1,
        fields optionally enclosed by '"',
        fields terminated by ','

    before load do
    $$ create table if not exists monthly_labour_market_updates
    (
        year int,
        month int,

        total_employed int,
        total_unemployed int,
        total_unemployed_previous int,

        employment_by_age_group_15_24 int,
        employment_by_age_group_25_54 int,
        employment_by_age_group_55 int,
        employment_by_age_group_15_24_previous int,
        employment_by_age_group_25_54_previous int,
        employment_by_age_group_55_previous int,

        employment_by_gender_women int,
        employment_by_gender_men int,
        employment_by_gender_women_previous int,
        employment_by_gender_men_previous int,

        employment_change_pct_total_employment numeric,
        employment_change_abs_total_employment int,
        employment_change_pct_full_time_jobs numeric,
        employment_change_abs_full_time_jobs int,
        employment_change_pct_part_time_jobs numeric,
        employment_change_abs_part_time_jobs int,

        employment_rate_change_pct_unemployment numeric,
        employment_rate_pct_unemployment numeric,
        employment_rate_change_pct_participation numeric,
        employment_rate_pct_participation numeric,
        employment_rate_change_pct_unemployment_previous numeric,
        employment_rate_pct_unemployment_previous numeric,
        employment_rate_change_pct_participation_previous numeric,
        employment_rate_pct_participation_previous numeric,

        population_british_columbia int,
        population_vancouver_island_and_coast int,
        population_lower_mainland_southwest int,
        population_thompson_okanagan int,
        population_kootenay int,
        population_cariboo int,
        population_north_coast_and_nechako int,
        population_northeast int,

        unemployment_pct_british_columbia numeric,
        unemployment_pct_british_columbia_previous numeric,
        total_jobs_british_columbia int,
        unemployment_pct_vancouver_island_coast numeric,
        unemployment_pct_vancouver_island_coast_previous numeric,
        total_jobs_vancouver_island_coast int,
        unemployment_pct_mainland_southwest numeric,
        unemployment_pct_mainland_southwest_previous numeric,
        total_jobs_mainland_southwest int,
        unemployment_pct_thompson_okanagan numeric,
        unemployment_pct_thompson_okanagan_previous numeric,
        total_jobs_thompson_okanagan int,
        unemployment_pct_kootenay numeric,
        unemployment_pct_kootenay_previous numeric,
        total_jobs_kootenay int,
        unemployment_pct_cariboo numeric,
        unemployment_pct_cariboo_previous numeric,
        total_jobs_cariboo int,
        unemployment_pct_north_coast_and_nechako numeric,
        unemployment_pct_north_coast_and_nechako_previous numeric,
        total_jobs_north_coast_and_nechako int,
        unemployment_pct_northeast numeric,
        unemployment_pct_northeast_previous numeric,
        total_jobs_northeast int,

        city_unemployment_pct_kelowna numeric,
        city_unemployment_pct_abbotsford_mission numeric,
        city_unemployment_pct_vancouver numeric,
        city_unemployment_pct_victoria numeric,

        industry_pct_accommodation_and_food_services numeric,
        industry_abs_accommodation_and_food_services int,
        industry_pct_agriculture numeric,
        industry_abs_agriculture int,
        industry_pct_construction numeric,
        industry_abs_construction int,
        industry_pct_educational_services numeric,
        industry_abs_educational_services int,
        industry_pct_finance_insurance_real_estate_rental numeric,
        industry_abs_finance_insurance_real_estate_rental int,
        industry_pct_health_care_and_social_assistance numeric,
        industry_abs_health_care_and_social_assistance int,
        industry_pct_manufacturing numeric,
        industry_abs_manufacturing int,
        industry_pct_other_primary numeric,
        industry_abs_other_primary int,
        industry_pct_other_services numeric,
        industry_abs_other_services int,
        industry_pct_professional_scientific_and_technical numeric,
        industry_abs_professional_scientific_and_technical int,
        industry_pct_public_administration numeric,
        industry_abs_public_administration int,
        industry_pct_transportation_and_warehousing numeric,
        industry_abs_transportation_and_warehousing int,
        industry_pct_utilities numeric,
        industry_abs_utilities int,
        industry_pct_wholesale_and_retail_trade numeric,
        industry_abs_wholesale_and_retail_trade int
    );
    $$

    after load do
    $$ create unique index if not exists monthly_labour_market_updates_date_idx on monthly_labour_market_updates (year, month); $$,
    $$ comment on table monthly_labour_market_updates is 'WorkBC LMS _<YYYY> <MMM>'; $$,
    $$ comment on column monthly_labour_market_updates.year is 'Report Year'; $$,
    $$ comment on column monthly_labour_market_updates.month is 'Report Month'; $$,

    $$ comment on column monthly_labour_market_updates.total_employed is 'Total BC Employed'; $$,
    $$ comment on column monthly_labour_market_updates.total_unemployed is 'Total Unemployed'; $$,
    $$ comment on column monthly_labour_market_updates.total_unemployed_previous is 'Total Unemployed (previous month)'; $$,

    $$ comment on column monthly_labour_market_updates.employment_by_age_group_15_24 is 'Employment by Age Group: 15-24 years'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_age_group_25_54 is 'Employment by Age Group: 25-54 years'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_age_group_55 is 'Employment by Age Group: 55+ years'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_age_group_15_24_previous is 'Employment by Age Group: 15-24 years (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_age_group_25_54_previous is 'Employment by Age Group: 25-54 years (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_age_group_55_previous is 'Employment by Age Group: 55+ years (previous month)'; $$,

    $$ comment on column monthly_labour_market_updates.employment_by_gender_women is 'Employment by Sex: Women'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_gender_men is 'Employment by Sex: Men'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_gender_women_previous is 'Employment by Sex: Women (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_by_gender_men_previous is 'Employment by Sex: Men (previous month)'; $$,

    $$ comment on column monthly_labour_market_updates.employment_change_pct_total_employment is 'BC Employment Trends: Total Employment - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_change_abs_total_employment is 'BC Employment Trends: Total Employment - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.employment_change_pct_full_time_jobs is 'BC Employment Trends: Full-time Jobs - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_change_abs_full_time_jobs is 'BC Employment Trends: Full-time Jobs - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.employment_change_pct_part_time_jobs is 'BC Employment Trends: Part-time Jobs - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_change_abs_part_time_jobs is 'BC Employment Trends: Part-time Jobs - Abs Change'; $$,

    $$ comment on column monthly_labour_market_updates.employment_rate_change_pct_unemployment is 'BC Employment Trends: Unemployment Rate - Change (pct points)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_rate_pct_unemployment is 'BC Employment Trends: Unemployment Rate - Rate (%)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_rate_change_pct_participation is 'BC Employment Trends: Participation Rate - Change (pct points)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_rate_pct_participation is 'BC Employment Trends: Participation Rate - Rate (%)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_rate_change_pct_unemployment_previous is 'BC Employment Trends: Unemployment Rate - Change (pct points) (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_rate_pct_unemployment_previous is 'BC Employment Trends: Unemployment Rate - Rate (%) (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_rate_change_pct_participation_previous is 'BC Employment Trends: Participation Rate - Change (pct points) (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.employment_rate_pct_participation_previous is 'BC Employment Trends: Participation Rate - Rate (%) (previous month)'; $$,

    $$ comment on column monthly_labour_market_updates.population_british_columbia is 'Regional Population: British Columbia'; $$,
    $$ comment on column monthly_labour_market_updates.population_vancouver_island_and_coast is 'Regional Population: Vancouver Island and Coast'; $$,
    $$ comment on column monthly_labour_market_updates.population_lower_mainland_southwest is 'Regional Population: Lower Mainland-Southwest'; $$,
    $$ comment on column monthly_labour_market_updates.population_thompson_okanagan is 'Regional Population: Thompson-Okanagan'; $$,
    $$ comment on column monthly_labour_market_updates.population_kootenay is 'Regional Population: Kootenay'; $$,
    $$ comment on column monthly_labour_market_updates.population_cariboo is 'Regional Population: Cariboo'; $$,
    $$ comment on column monthly_labour_market_updates.population_north_coast_and_nechako is 'Regional Population: North Coast and Nechako'; $$,
    $$ comment on column monthly_labour_market_updates.population_northeast is 'Regional Population: Northeast'; $$,

    $$ comment on column monthly_labour_market_updates.unemployment_pct_british_columbia is 'Regional Unemployment - Rate (%): British Columbia'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_british_columbia_previous is 'Regional Unemployment - Rate (%): British Columbia (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_british_columbia is 'Total Number of Jobs: British Columbia'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_vancouver_island_coast is 'Regional Unemployment - Rate (%): Vancouver Island/Coast'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_vancouver_island_coast_previous is 'Regional Unemployment - Rate (%): Vancouver Island/Coast (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_vancouver_island_coast is 'Total Number of Jobs: Vancouver Island/Coast'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_mainland_southwest is 'Regional Unemployment - Rate (%): Mainland/Southwest'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_mainland_southwest_previous is 'Regional Unemployment - Rate (%): Mainland/Southwest (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_mainland_southwest is 'Total Number of Jobs: Mainland/Southwest'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_thompson_okanagan is 'Regional Unemployment - Rate (%): Thompson-Okanagan'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_thompson_okanagan_previous is 'Regional Unemployment - Rate (%): Thompson-Okanagan (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_thompson_okanagan is 'Total Number of Jobs: Thompson-Okanagan'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_kootenay is 'Regional Unemployment - Rate (%): Kootenay'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_kootenay_previous is 'Regional Unemployment - Rate (%): Kootenay (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_kootenay is 'Total Number of Jobs: Kootenay'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_cariboo is 'Regional Unemployment - Rate (%): Cariboo'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_cariboo_previous is 'Regional Unemployment - Rate (%): Cariboo (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_cariboo is 'Total Number of Jobs: Cariboo'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_north_coast_and_nechako is 'Regional Unemployment - Rate (%): North Coast and Nechako'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_north_coast_and_nechako_previous is 'Regional Unemployment - Rate (%): North Coast and Nechako (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_north_coast_and_nechako is 'Total Number of Jobs: North Coast and Nechako'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_northeast is 'Regional Unemployment - Rate (%): Northeast'; $$,
    $$ comment on column monthly_labour_market_updates.unemployment_pct_northeast_previous is 'Regional Unemployment - Rate (%): Northeast (previous month)'; $$,
    $$ comment on column monthly_labour_market_updates.total_jobs_northeast is 'Total Number of Jobs: Northeast'; $$,

    $$ comment on column monthly_labour_market_updates.city_unemployment_pct_kelowna is 'City Unemployment Rate (%): Kelowna'; $$,
    $$ comment on column monthly_labour_market_updates.city_unemployment_pct_abbotsford_mission is 'City Unemployment Rate (%): Abbotsford-Mission'; $$,
    $$ comment on column monthly_labour_market_updates.city_unemployment_pct_vancouver is 'City Unemployment Rate (%): Vancouver'; $$,
    $$ comment on column monthly_labour_market_updates.city_unemployment_pct_victoria is 'City Unemployment Rate (%): Victoria'; $$,

    $$ comment on column monthly_labour_market_updates.industry_pct_accommodation_and_food_services is 'Industry Highlights: Accommodation and food services - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_accommodation_and_food_services is 'Industry Highlights: Accommodation and food services - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_agriculture is 'Industry Highlights: Agriculture - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_agriculture is 'Industry Highlights: Agriculture - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_construction is 'Industry Highlights: Construction - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_construction is 'Industry Highlights: Construction - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_educational_services is 'Industry Highlights: Educational services - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_educational_services is 'Industry Highlights: Educational services - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_finance_insurance_real_estate_rental is 'Industry Highlights: Finance, insurance, real estate, rental and leasing - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_finance_insurance_real_estate_rental is 'Industry Highlights: Finance, insurance, real estate, rental and leasing - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_health_care_and_social_assistance is 'Industry Highlights: Health care and social assistance - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_health_care_and_social_assistance is 'Industry Highlights: Health care and social assistance - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_manufacturing is 'Industry Highlights: Manufacturing - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_manufacturing is 'Industry Highlights: Manufacturing - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_other_primary is 'Industry Highlights: Other Primary - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_other_primary is 'Industry Highlights: Other Primary - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_other_services is 'Industry Highlights: Other services (except public administration) - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_other_services is 'Industry Highlights: Other services (except public administration) - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_professional_scientific_and_technical is 'Industry Highlights: Professional, scientific and technical services - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_professional_scientific_and_technical is 'Industry Highlights: Professional, scientific and technical services - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_public_administration is 'Industry Highlights: Public administration - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_public_administration is 'Industry Highlights: Public administration - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_transportation_and_warehousing is 'Industry Highlights: Transportation and warehousing - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_transportation_and_warehousing is 'Industry Highlights: Transportation and warehousing - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_utilities is 'Industry Highlights: Utilities - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_utilities is 'Industry Highlights: Utilities - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_pct_wholesale_and_retail_trade is 'Industry Highlights: Wholesale and retail trade - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_abs_wholesale_and_retail_trade is 'Industry Highlights: Wholesale and retail trade - Abs Change'; $$
;
