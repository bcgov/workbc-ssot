load csv
    from '{{ SOURCE }}'
    (
        year,
        month,
        bc_employment_trends_change_pct_total_employment,
        bc_employment_trends_change_abs_total_employment,
        bc_employment_trends_change_pct_full_time_jobs,
        bc_employment_trends_change_abs_full_time_jobs,
        bc_employment_trends_change_pct_part_time_jobs,
        bc_employment_trends_change_abs_part_time_jobs,
        bc_employment_trends_rate_change_pct_unemployment,
        bc_employment_trends_rate_pct_unemployment,
        bc_employment_trends_rate_change_pct_participation,
        bc_employment_trends_rate_pct_participation,
        regional_population_british_columbia,
        regional_population_vancouver_island_and_coast,
        regional_population_lower_mainland_southwest,
        regional_population_thompson_okanagan,
        regional_population_kootenay,
        regional_population_cariboo,
        regional_population_north_coast_and_nechako,
        regional_population_northeast,
        regional_unemployment_rate_pct_british_columbia,
        regional_unemployment_total_british_columbia,
        regional_unemployment_rate_pct_vancouver_island_coast,
        regional_unemployment_total_vancouver_island_coast,
        regional_unemployment_rate_pct_mainland_southwest,
        regional_unemployment_total_mainland_southwest,
        regional_unemployment_rate_pct_thompson_okanagan,
        regional_unemployment_total_thompson_okanagan,
        regional_unemployment_rate_pct_kootenay,
        regional_unemployment_total_kootenay,
        regional_unemployment_rate_pct_cariboo,
        regional_unemployment_total_cariboo,
        regional_unemployment_rate_pct_north_coast_and_nechako,
        regional_unemployment_total_north_coast_and_nechako,
        regional_unemployment_rate_pct_northeast,
        regional_unemployment_total_northeast,
        city_unemployment_rate_pct_kelowna,
        city_unemployment_rate_pct_abbotsford_mission,
        city_unemployment_rate_pct_vancouver,
        city_unemployment_rate_pct_victoria,
        industry_highlights_pct_accommodation_and_food_services,
        industry_highlights_abs_accommodation_and_food_services,
        industry_highlights_pct_agriculture,
        industry_highlights_abs_agriculture,
        industry_highlights_pct_construction,
        industry_highlights_abs_construction,
        industry_highlights_pct_educational_services,
        industry_highlights_abs_educational_services,
        industry_highlights_pct_finance_insurance_real_estate_rental,
        industry_highlights_abs_finance_insurance_real_estate_rental,
        industry_highlights_pct_health_care_and_social_assistance,
        industry_highlights_abs_health_care_and_social_assistance,
        industry_highlights_pct_manufacturing,
        industry_highlights_abs_manufacturing,
        industry_highlights_pct_other_primary,
        industry_highlights_abs_other_primary,
        industry_highlights_pct_other_services,
        industry_highlights_abs_other_services,
        industry_highlights_pct_professional_scientific_and_technical,
        industry_highlights_abs_professional_scientific_and_technical,
        industry_highlights_pct_public_administration,
        industry_highlights_abs_public_administration,
        industry_highlights_pct_transportation_and_warehousing,
        industry_highlights_abs_transportation_and_warehousing,
        industry_highlights_pct_utilities,
        industry_highlights_abs_utilities,
        industry_highlights_pct_wholesale_and_retail_trade,
        industry_highlights_abs_wholesale_and_retail_trade
    )
    into postgresql:///ssot
    target table monthly_labour_market_updates
    with
        skip header = 1,
        fields optionally enclosed by '"',
        fields terminated by ','

    before load do
    $$ create table if not exists monthly_labour_market_updates
    (
        year int,
        month int,
        bc_employment_trends_change_pct_total_employment numeric,
        bc_employment_trends_change_abs_total_employment int,
        bc_employment_trends_change_pct_full_time_jobs numeric,
        bc_employment_trends_change_abs_full_time_jobs int,
        bc_employment_trends_change_pct_part_time_jobs numeric,
        bc_employment_trends_change_abs_part_time_jobs int,
        bc_employment_trends_rate_change_pct_unemployment numeric,
        bc_employment_trends_rate_pct_unemployment numeric,
        bc_employment_trends_rate_change_pct_participation numeric,
        bc_employment_trends_rate_pct_participation numeric,
        regional_population_british_columbia int,
        regional_population_vancouver_island_and_coast int,
        regional_population_lower_mainland_southwest int,
        regional_population_thompson_okanagan int,
        regional_population_kootenay int,
        regional_population_cariboo int,
        regional_population_north_coast_and_nechako int,
        regional_population_northeast int,
        regional_unemployment_rate_pct_british_columbia numeric,
        regional_unemployment_total_british_columbia int,
        regional_unemployment_rate_pct_vancouver_island_coast numeric,
        regional_unemployment_total_vancouver_island_coast int,
        regional_unemployment_rate_pct_mainland_southwest numeric,
        regional_unemployment_total_mainland_southwest int,
        regional_unemployment_rate_pct_thompson_okanagan numeric,
        regional_unemployment_total_thompson_okanagan int,
        regional_unemployment_rate_pct_kootenay numeric,
        regional_unemployment_total_kootenay int,
        regional_unemployment_rate_pct_cariboo numeric,
        regional_unemployment_total_cariboo int,
        regional_unemployment_rate_pct_north_coast_and_nechako numeric,
        regional_unemployment_total_north_coast_and_nechako int,
        regional_unemployment_rate_pct_northeast numeric,
        regional_unemployment_total_northeast int,
        city_unemployment_rate_pct_kelowna numeric,
        city_unemployment_rate_pct_abbotsford_mission numeric,
        city_unemployment_rate_pct_vancouver numeric,
        city_unemployment_rate_pct_victoria numeric,
        industry_highlights_pct_accommodation_and_food_services numeric,
        industry_highlights_abs_accommodation_and_food_services int,
        industry_highlights_pct_agriculture numeric,
        industry_highlights_abs_agriculture int,
        industry_highlights_pct_construction numeric,
        industry_highlights_abs_construction int,
        industry_highlights_pct_educational_services numeric,
        industry_highlights_abs_educational_services int,
        industry_highlights_pct_finance_insurance_real_estate_rental numeric,
        industry_highlights_abs_finance_insurance_real_estate_rental int,
        industry_highlights_pct_health_care_and_social_assistance numeric,
        industry_highlights_abs_health_care_and_social_assistance int,
        industry_highlights_pct_manufacturing numeric,
        industry_highlights_abs_manufacturing int,
        industry_highlights_pct_other_primary numeric,
        industry_highlights_abs_other_primary int,
        industry_highlights_pct_other_services numeric,
        industry_highlights_abs_other_services int,
        industry_highlights_pct_professional_scientific_and_technical numeric,
        industry_highlights_abs_professional_scientific_and_technical int,
        industry_highlights_pct_public_administration numeric,
        industry_highlights_abs_public_administration int,
        industry_highlights_pct_transportation_and_warehousing numeric,
        industry_highlights_abs_transportation_and_warehousing int,
        industry_highlights_pct_utilities numeric,
        industry_highlights_abs_utilities int,
        industry_highlights_pct_wholesale_and_retail_trade numeric,
        industry_highlights_abs_wholesale_and_retail_trade int
    );
    $$

    after load do
    $$ create unique index if not exists monthly_labour_market_updates_date_idx on monthly_labour_market_updates (year, month); $$,
    $$ comment on table monthly_labour_market_updates is 'WorkBC LMS _<YYYY> <MMM>'; $$,
    $$ comment on column monthly_labour_market_updates.year is 'Report Year'; $$,
    $$ comment on column monthly_labour_market_updates.month is 'Report Month'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_change_pct_total_employment is 'BC Employment Trends: Total Employment - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_change_abs_total_employment is 'BC Employment Trends: Total Employment - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_change_pct_full_time_jobs is 'BC Employment Trends: Full-time Jobs - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_change_abs_full_time_jobs is 'BC Employment Trends: Full-time Jobs - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_change_pct_part_time_jobs is 'BC Employment Trends: Part-time Jobs - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_change_abs_part_time_jobs is 'BC Employment Trends: Part-time Jobs - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_rate_change_pct_unemployment is 'BC Employment Trends: Unemployment Rate - Change (pct points)'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_rate_pct_unemployment is 'BC Employment Trends: Unemployment Rate - Rate (%)'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_rate_change_pct_participation is 'BC Employment Trends: Participation Rate - Change (pct points)'; $$,
    $$ comment on column monthly_labour_market_updates.bc_employment_trends_rate_pct_participation is 'BC Employment Trends: Participation Rate - Rate (%)'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_british_columbia is 'Regional Population: British Columbia'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_vancouver_island_and_coast is 'Regional Population: Vancouver Island and Coast'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_lower_mainland_southwest is 'Regional Population: Lower Mainland-Southwest'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_thompson_okanagan is 'Regional Population: Thompson-Okanagan'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_kootenay is 'Regional Population: Kootenay'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_cariboo is 'Regional Population: Cariboo'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_north_coast_and_nechako is 'Regional Population: North Coast and Nechako'; $$,
    $$ comment on column monthly_labour_market_updates.regional_population_northeast is 'Regional Population: Northeast'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_british_columbia is 'Regional Unemployment - Rate (%): British Columbia'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_british_columbia is 'Regional Unemployment - Total Number of Jobs: British Columbia'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_vancouver_island_coast is 'Regional Unemployment - Rate (%): Vancouver Island/Coast'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_vancouver_island_coast is 'Regional Unemployment - Total Number of Jobs: Vancouver Island/Coast'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_mainland_southwest is 'Regional Unemployment - Rate (%): Mainland/Southwest'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_mainland_southwest is 'Regional Unemployment - Total Number of Jobs: Mainland/Southwest'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_thompson_okanagan is 'Regional Unemployment - Rate (%): Thompson-Okanagan'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_thompson_okanagan is 'Regional Unemployment - Total Number of Jobs: Thompson-Okanagan'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_kootenay is 'Regional Unemployment - Rate (%): Kootenay'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_kootenay is 'Regional Unemployment - Total Number of Jobs: Kootenay'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_cariboo is 'Regional Unemployment - Rate (%): Cariboo'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_cariboo is 'Regional Unemployment - Total Number of Jobs: Cariboo'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_north_coast_and_nechako is 'Regional Unemployment - Rate (%): North Coast and Nechako'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_north_coast_and_nechako is 'Regional Unemployment - Total Number of Jobs: North Coast and Nechako'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_rate_pct_northeast is 'Regional Unemployment - Rate (%): Northeast'; $$,
    $$ comment on column monthly_labour_market_updates.regional_unemployment_total_northeast is 'Regional Unemployment - Total Number of Jobs: Northeast'; $$,
    $$ comment on column monthly_labour_market_updates.city_unemployment_rate_pct_kelowna is 'City Unemployment Rate (%): Kelowna'; $$,
    $$ comment on column monthly_labour_market_updates.city_unemployment_rate_pct_abbotsford_mission is 'City Unemployment Rate (%): Abbotsford-Mission'; $$,
    $$ comment on column monthly_labour_market_updates.city_unemployment_rate_pct_vancouver is 'City Unemployment Rate (%): Vancouver'; $$,
    $$ comment on column monthly_labour_market_updates.city_unemployment_rate_pct_victoria is 'City Unemployment Rate (%): Victoria'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_accommodation_and_food_services is 'Industry Highlights: Accommodation and food services - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_accommodation_and_food_services is 'Industry Highlights: Accommodation and food services - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_agriculture is 'Industry Highlights: Agriculture - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_agriculture is 'Industry Highlights: Agriculture - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_construction is 'Industry Highlights: Construction - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_construction is 'Industry Highlights: Construction - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_educational_services is 'Industry Highlights: Educational services - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_educational_services is 'Industry Highlights: Educational services - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_finance_insurance_real_estate_rental is 'Industry Highlights: Finance, insurance, real estate, rental and leasing - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_finance_insurance_real_estate_rental is 'Industry Highlights: Finance, insurance, real estate, rental and leasing - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_health_care_and_social_assistance is 'Industry Highlights: Health care and social assistance - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_health_care_and_social_assistance is 'Industry Highlights: Health care and social assistance - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_manufacturing is 'Industry Highlights: Manufacturing - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_manufacturing is 'Industry Highlights: Manufacturing - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_other_primary is 'Industry Highlights: Other Primary - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_other_primary is 'Industry Highlights: Other Primary - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_other_services is 'Industry Highlights: Other services (except public administration) - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_other_services is 'Industry Highlights: Other services (except public administration) - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_professional_scientific_and_technical is 'Industry Highlights: Professional, scientific and technical services - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_professional_scientific_and_technical is 'Industry Highlights: Professional, scientific and technical services - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_public_administration is 'Industry Highlights: Public administration - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_public_administration is 'Industry Highlights: Public administration - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_transportation_and_warehousing is 'Industry Highlights: Transportation and warehousing - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_transportation_and_warehousing is 'Industry Highlights: Transportation and warehousing - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_utilities is 'Industry Highlights: Utilities - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_utilities is 'Industry Highlights: Utilities - Abs Change'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_pct_wholesale_and_retail_trade is 'Industry Highlights: Wholesale and retail trade - Change (%)'; $$,
    $$ comment on column monthly_labour_market_updates.industry_highlights_abs_wholesale_and_retail_trade is 'Industry Highlights: Wholesale and retail trade - Abs Change'; $$
;
